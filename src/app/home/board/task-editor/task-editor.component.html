<form [formGroup]="formGr">
  <div class="container">

    <div class="navigation">
      <button class="navigation__button flaticon-060-diskette" (click)="onSubmit()"></button>
      <button class="navigation__button flaticon-028-trash" (click)="delete(task)" *ngIf="task.id"></button>
      <button class="navigation__button flaticon-193-cancel" [mat-dialog-close]="true" ></button>
    </div>

    <div class="progress">
      <div class="progress__status-container">
        <div class="progress__status {{task.status}}">{{task.status | uppercase}}</div>
        <div class="progress__next {{task.status}}" (click)="changeStatus(task)"></div>
      </div>
      <select formControlName="assignedTo" class="select-priority">
        <option disabled>Select developer</option>
        <ng-container *ngFor="let dev of developers">
          <option value="{{dev.displayName}}">{{dev.displayName}}</option>
        </ng-container>
      </select>
    </div>

    <div class="properties">
      <div class="property">
        <h1 class="property__title">TICKET NUMBER</h1>
        <div class="property__value">{{task.id | truncate}}</div>
      </div>
      <div class="property">
        <h1 class="property__title">CREATED</h1>
        <div class="property__value">{{task.created | date}}</div>
      </div>
      <div class="property">
        <h1 class="property__title">DUE DATE</h1>
        <input type="date" class="property__value" formControlName="dueDate" appCheckDueDate="{{task.dueDate}}">
      </div>
      <select formControlName="priority" class="select-priority">
        <option disabled>Select priority</option>
        <option value="High Priority">High Priority</option>
        <option value="Med Priority">Med Priority</option>
        <option value="Low Priority">Low Priority</option>
      </select>
    </div>

    <div class="task-info">
      <input class="task-info__name" [class.error]="isControlInvalid('name')"
             placeholder="Task name" type="text" formControlName="name" ngxTrim>
      <h1 class="task-info__title">INFO</h1>
      <div class="task-info__tags">
        <ng-container *ngIf="task.tags">
          <app-tags *ngFor="let tag of task.tags" [tagId]="tag" (click)="removeTag(tag)"></app-tags>
        </ng-container>
        <button class="task-info__tag-btn" (click)="toggle('TagWindow')">+</button>
      </div>
      <div class="task-info__add-tags" *ngIf="openTagWindow">
        <button class="task-info__tag-btn" (click)="toggle('NewTagWindow')">+</button>
        <app-tags *ngFor="let tag of tags"
             (click)="addTag(tag.id)"
                  [tagId]="tag.id"></app-tags>
        <div class="task-info__add-tags" *ngIf="openNewTagWindow">
          <input type="text" class="set-tag" #inputElementTag placeholder="create new tag">
          <button class="set-color-btn" *ngFor="let color of tagColors"
                  appSetBackground="{{color}}"
                  (click)="addNewTag(color)"
          ></button>
        </div>
      </div>
      <textarea class="task-info__text" [class.error]="isControlInvalid('info')"
                placeholder="Add some info here" formControlName="info" maxlength="1000"></textarea>
    </div>

    <div class="event-log">
      <ng-container *ngIf="task.comments.length" >
        <ng-container *ngFor="let comment of task.comments">
          <div class="event-log__comment">{{comment}}</div>
        </ng-container>
      </ng-container>
    </div>

    <div class="add-attachment"></div>

    <div class="add-comment">
      <input class="add-comment__text" placeholder="Add comment..." type="text" ngxTrim value="" #inputElementComment>
      <button class="add-comment__btn" (click)="addComment()">Add</button>
    </div>

  </div>
</form>
